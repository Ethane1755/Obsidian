'use strict';

var obsidian = require('obsidian');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

var formatUtil = {
    condenseContent(content) {
        // 将 制表符 改成 四个空格
        content = content.replace(/\t/g, '    ');
        // 删除超过2个的回车
        // Unix 的只有 LF，Windows 的需要 CR LF
        content = content.replace(/(\n){3,}/g, '$1$1');
        content = content.replace(/(\r\n){3,}/g, '$1$1');
        return content;
    },
    getIgnoreBlocks(lines, token = '```') {
        const ignoreBlocks = [];
        let block = null;
        lines.forEach((line, index) => {
            line = line.trim();
            if (line.startsWith(token)) {
                if (!block) {
                    block = { start: index, end: null };
                }
                else {
                    if (line === token) {
                        block.end = index;
                        ignoreBlocks.push(block);
                        block = null;
                    }
                }
            }
        });
        return ignoreBlocks;
    },
    deleteSpaces(content) {
        // 去掉「`()[]{}<>'"`」: 前后多余的空格
        content = content.replace(/\s+([\(\)\[\]\{\}<>'":])\s+/g, ' $1 ');
        // 去掉连续括号增加的空格，例如：「` ( [ { <  > } ] ) `」
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, '$1$2 ');
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, '$1$2 ');
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, '$1$2 ');
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, '$1$2 ');
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, ' $1$2');
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, ' $1$2');
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, ' $1$2');
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, ' $1$2');
        // 去掉 「`$ () $`」, 「`$ [] $`」, 「`$ {} $`」 里面增加的空格
        // 去掉开始 $ 后面增加的空格，结束 $ 前面增加的空格
        // 去掉包裹代码的符号里面增加的空格
        // 去掉开始 ` 后面增加的空格，结束 ` 前面增加的空格
        content = content.replace(/([`\$])\s*([<\(\[\{])([^\$]*)\s*([`\$])/g, '$1$2$3$4');
        content = content.replace(/([`\$])\s*([^\$]*)([>\)\]\}])\s*([`\$])/g, '$1$2$3$4');
        // 去掉「`) _`」、「`) ^`」增加的空格
        content = content.replace(/\)\s([_\^])/g, ')$1');
        // 去掉 [^footnote,2002] 中的空格
        content = content.replace(/\[\s*\^([^\]\s]*)\s*\]/g, '[^$1]');
        // 将链接的格式中文括号“[]（）”改成英文括号“[]()”，去掉增加的空格
        content = content.replace(/\s*\[\s*([^\]]+)\s*\]\s*[（(]\s*([^\s\)]*)\s*[)）]\s*/g, ' [$1]($2) ');
        // 将图片链接的格式中的多余空格“! []()”去掉，变成“![]()”
        content = content.replace(/!\s*\[\s*([^\]]+)\s*\]\s*[（(]\s*([^\s\)]*)\s*[)）]\s*/g, '![$1]($2) ');
        // 将网络地址中“ : // ”符号改成“://”
        content = content.replace(/\s*:\s*\/\s*\/\s*/g, '://');
        // 去掉行末空格
        content = content.replace(/(\S*)\s*$/g, '$1');
        // 去掉「123 °」和 「15 %」中的空格
        content = content.replace(/([0-9])\s*([°%])/g, '$1$2');
        // 去掉 2020 - 04 - 20, 08 : 00 : 00 这种日期时间表示的数字内的空格
        content = content.replace(/([0-9])\s*-\s*([0-9])/g, '$1-$2');
        content = content.replace(/([0-9])\s*:\s*([0-9])/g, '$1:$2');
        // 去掉 1 , 234 , 567 这种千分位表示的数字内的空格
        content = content.replace(/([0-9])\s*,\s*([0-9])/g, '$1,$2');
        // 全角標點與其他字符之間不加空格
        // 将无序列表的-后面的空格保留
        // 将有序列表的-后面的空格保留
        content = content.replace(/^(?<![-|\d.]\s*)\s*([，。、《》？『』「」；∶【】｛｝—！＠￥％…（）])\s*/g, '$1');
        return content;
    },
    insertSpace(content) {
        // 在 “中文English” 之间加入空格 “中文 English”
        // 在 “中文123” 之间加入空格 “中文 123”
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])([a-zA-Z0-9`])/g, '$1 $2');
        // 在 “English中文” 之间加入空格 “English 中文”
        // 在 “123中文” 之间加入空格 “123 中文”
        content = content.replace(/([a-zA-Z0-9%`])([*]*[\u4e00-\u9fa5\u3040-\u30FF])/g, '$1 $2');
        // 在 「I said:it's a good news」的冒号与英文之间加入空格 「I said: it's a good news」
        content = content.replace(/([:])\s*([a-zA-z])/g, '$1 $2');
        return content;
    },
    replacePunctuations(content) {
        // `, \ . : ; ? !` 改成 `，、。：；？！`
        // 必须在结尾或者有空格的点才被改成句号
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])\.($|\s*)/g, '$1。');
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF]),/g, '$1，');
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF]);/g, '$1；');
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])!/g, '$1！');
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])\?/g, '$1？');
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])\\/g, '$1、');
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])＼s*\:/g, '$1：');
        // 簡體中文使用直角引號
        content = content.replace(/‘/g, '『');
        content = content.replace(/’/g, '』');
        content = content.replace(/“/g, '「');
        content = content.replace(/”/g, '」');
        // 括号使用半角标点
        // 半角括号的两边都有空格就不在这里处理了，放到行中处理
        content = content.replace(/\s*[（(]\s*/g, ' ( ');
        content = content.replace(/\s*[）)]\s*/g, ' ) ');
        // 英文和数字内部的全角标点 `，。；‘’“”：？！＠＃％＆－＝＋｛｝【】｜＼～`改成半角标点
        content = content.replace(/(\w)\s*，\s*(\w)/g, '$1, $2');
        content = content.replace(/(\w)\s*。\s*(\w)/g, '$1. $2');
        content = content.replace(/(\w)\s*；\s*(\w)/g, '$1; $2');
        content = content.replace(/(\w)\s*‘\s*(\w)/g, "$1 '$2");
        content = content.replace(/(\w)\s*’\s*(\w)/g, "$1' $2");
        content = content.replace(/(\w)\s*“\s*(\w)/g, '$1 "$2');
        content = content.replace(/(\w)\s*”\s*(\w)/g, '$1" $2');
        content = content.replace(/(\w)\s*：\s*(\w)/g, '$1: $2');
        content = content.replace(/(\w)\s*？\s*(\w)/g, '$1? $2');
        content = content.replace(/(\w)\s*！\s*(\w)/g, '$1! $2');
        content = content.replace(/(\w)\s*＠\s*(\w)/g, '$1@$2');
        content = content.replace(/(\w)\s*＃\s*(\w)/g, '$1#$2');
        content = content.replace(/(\w)\s*％\s*(\w)/g, '$1 % $2');
        content = content.replace(/(\w)\s*＆\s*(\w)/g, '$1 & $2');
        content = content.replace(/(\w)\s*－\s*(\w)/g, '$1 - $2');
        content = content.replace(/(\w)\s*＝\s*(\w)/g, '$1 = $2');
        content = content.replace(/(\w)\s*＋\s*(\w)/g, '$1 + $2');
        content = content.replace(/(\w)\s*｛\s*(\w)/g, '$1 {$2');
        content = content.replace(/(\w)\s*｝\s*(\w)/g, '$1} $2');
        content = content.replace(/(\w)\s*[【\[]\s*(\w)/g, '$1 [$2');
        content = content.replace(/(\w)\s*[】\]]\s*(\w)/g, '$1] $2');
        content = content.replace(/(\w)\s*｜\s*(\w)/g, '$1 | $2');
        content = content.replace(/(\w)\s*＼\s*(\w)/g, '$1  $2');
        content = content.replace(/(\w)\s*～\s*(\w)/g, '$1~$2');
        // 连续三个以上的 `。` 改成 `......`
        content = content.replace(/[。]{3,}/g, '……');
        // 截断连续超过一个的 ？和！ 为一个，「！？」也算一个
        content = content.replace(/([！？]+)\1{1,}/g, '$1');
        // 截断连续超过一个的 。，；：、“”『』〖〗《》 为一个
        content = content.replace(/([。，；：、“”『』〖〗《》【】])\1{1,}/g, '$1');
        return content;
    },
    replaceFullNumbersAndChars(content) {
        // 替换全角数字 & 全角英文
        // Ａ -> A
        // ０ -> 0
        return content.replace(/[\uFF10-\uFF19\uFF21-\uFF5A]/g, c => String.fromCharCode(c.charCodeAt(0) - 0xfee0));
    },
    formatContent(content) {
        // 替换所有的全角数字和字母为半角
        content = this.replaceFullNumbersAndChars(content);
        // 删除多余的内容（回车）
        content = this.condenseContent(content);
        // 每行操作
        const lines = content
            .split('\n');
        const ignoreBlocks = this.getIgnoreBlocks(lines);
        content = lines
            .map((line, index) => {
            // 忽略代码块
            if (ignoreBlocks.some(({ start, end }) => {
                return index >= start && index <= end;
            })) {
                return line;
            }
            // 删除多余的空格
            line = this.deleteSpaces(line);
            // 插入必要的空格
            line = this.insertSpace(line);
            // 将有编号列表的“1. ”改成 “1.  ”
            line = line.replace(/^(\s*)(\d\.)\s+(\S)/, '$1$2  $3');
            // 将无编号列表的“* ”改成 “- ”
            // 将无编号列表的“- ”改成 “- ”
            line = line.replace(/^(\s*)[-\*]\s+(\S)/, '$1- $2');
            return line;
        })
            .join('\n');
        // 结束文档整理前再删除最后一个回车
        content = content.replace(/(\n){2,}$/g, '$1');
        content = content.replace(/(\r\n){2,}$/g, '$1');
        return content;
    },
};

class Pangu extends obsidian.Plugin {
    format(cm) {
        let cursor = cm.getCursor();
        let cursorContent = cm.getRange(Object.assign(Object.assign({}, cursor), { ch: 0 }), cursor);
        const { top } = cm.getScrollInfo();
        cursorContent = formatUtil.formatContent(cursorContent);
        let content = cm.getValue().trim();
        content = content + '\n\n';
        content = formatUtil.formatContent(content);
        cm.setValue(content);
        cm.scrollTo(null, top);
        // 保持光标格式化后不变
        const newDocLine = cm.getLine(cursor.line);
        try {
            cursor = Object.assign(Object.assign({}, cursor), { ch: newDocLine.indexOf(cursorContent) + cursorContent.length });
        }
        catch (error) { }
        cm.setCursor(cursor);
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.addCommand({
                id: 'pangu-format',
                name: '为中英文字符间自动加入空格',
                callback: () => {
                    const activeLeafView = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
                    if (activeLeafView) {
                        this.format(activeLeafView.sourceMode.cmEditor);
                    }
                },
                hotkeys: [
                    {
                        modifiers: ['Mod', 'Shift'],
                        key: 's',
                    },
                    {
                        modifiers: ['Ctrl', 'Shift'],
                        key: 's',
                    },
                ],
            });
            this.addSettingTab(new PanguSettingTab(this.app, this));
        });
    }
    onunload() {
        console.log('unloading plugin');
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () { });
    }
}
class PanguSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Pangu 使用说明' });
        new obsidian.Setting(containerEl).setName('').setDesc('默认快捷键为:Mac - Command + Shift + S，Windows -  Shift + Ctrl + S。当然，您可以到「设置 - 快捷键」里进行更改。');
    }
}

module.exports = Pangu;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsImZvcm1hdFV0aWwudHMiLCJtYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgbykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBwKSkgX19jcmVhdGVCaW5kaW5nKG8sIG0sIHApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5KHRvLCBmcm9tLCBwYWNrKSB7XHJcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcclxuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcclxuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgZnJvbSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcclxufSkgOiBmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcclxuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBnZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWFkIHByaXZhdGUgbWVtYmVyIGZyb20gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIHNldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcclxufVxyXG4iLCJcbmludGVyZmFjZSBJZ25vcmVCbG9jayB7XG4gIHN0YXJ0OiBudW1iZXIgfCBudWxsLFxuICBlbmQ6IG51bWJlciB8IG51bGxcbn1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgY29uZGVuc2VDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8g5bCGIOWItuihqOespiDmlLnmiJAg5Zub5Liq56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFx0L2csICcgICAgJyk7XG5cbiAgICAvLyDliKDpmaTotoXov4cy5Liq55qE5Zue6L2mXG4gICAgLy8gVW5peCDnmoTlj6rmnIkgTEbvvIxXaW5kb3dzIOeahOmcgOimgSBDUiBMRlxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXG4pezMsfS9nLCAnJDEkMScpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHJcXG4pezMsfS9nLCAnJDEkMScpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9LFxuICBnZXRJZ25vcmVCbG9ja3MobGluZXM6IHN0cmluZ1tdLCB0b2tlbjogc3RyaW5nID0gJ2BgYCcpOiBJZ25vcmVCbG9ja1tdIHtcbiAgICBjb25zdCBpZ25vcmVCbG9ja3M6IElnbm9yZUJsb2NrW10gPSBbXTtcbiAgICBsZXQgYmxvY2s6IElnbm9yZUJsb2NrIHwgbnVsbCA9IG51bGw7XG4gICAgbGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgIGxpbmUgPSBsaW5lLnRyaW0oKTtcbiAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgodG9rZW4pKSB7XG4gICAgICAgIGlmICghYmxvY2spIHtcbiAgICAgICAgICBibG9jayA9IHsgc3RhcnQ6IGluZGV4LCBlbmQ6IG51bGwgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAobGluZSA9PT0gdG9rZW4pIHtcbiAgICAgICAgICAgIGJsb2NrLmVuZCA9IGluZGV4XG4gICAgICAgICAgICBpZ25vcmVCbG9ja3MucHVzaChibG9jayk7XG4gICAgICAgICAgICBibG9jayA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGlnbm9yZUJsb2NrcztcbiAgfSxcbiAgZGVsZXRlU3BhY2VzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8g5Y675o6J44CMYCgpW117fTw+J1wiYOOAjTog5YmN5ZCO5aSa5L2Z55qE56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKyhbXFwoXFwpXFxbXFxdXFx7XFx9PD4nXCI6XSlcXHMrL2csICcgJDEgJyk7XG5cbiAgICAvLyDljrvmjonov57nu63mi6zlj7flop7liqDnmoTnqbrmoLzvvIzkvovlpoLvvJrjgIxgICggWyB7IDwgID4gfSBdICkgYOOAjVxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbPFxcKFxce1xcW10pXFxzKFs8XFwoXFx7XFxbXSlcXHMvZywgJyQxJDIgJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFs8XFwoXFx7XFxbXSlcXHMoWzxcXChcXHtcXFtdKVxccy9nLCAnJDEkMiAnKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oWzxcXChcXHtcXFtdKVxccyhbPFxcKFxce1xcW10pXFxzL2csICckMSQyICcpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbPFxcKFxce1xcW10pXFxzKFs8XFwoXFx7XFxbXSlcXHMvZywgJyQxJDIgJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKFs+XFwpXFxdXFx9XSlcXHMoWz5cXClcXF1cXH1dKS9nLCAnICQxJDInKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHMoWz5cXClcXF1cXH1dKVxccyhbPlxcKVxcXVxcfV0pL2csICcgJDEkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xccyhbPlxcKVxcXVxcfV0pXFxzKFs+XFwpXFxdXFx9XSkvZywgJyAkMSQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKFs+XFwpXFxdXFx9XSlcXHMoWz5cXClcXF1cXH1dKS9nLCAnICQxJDInKTtcblxuICAgIC8vIOWOu+aOiSDjgIxgJCAoKSAkYOOAjSwg44CMYCQgW10gJGDjgI0sIOOAjGAkIHt9ICRg44CNIOmHjOmdouWinuWKoOeahOepuuagvFxuICAgIC8vIOWOu+aOieW8gOWniyAkIOWQjumdouWinuWKoOeahOepuuagvO+8jOe7k+adnyAkIOWJjemdouWinuWKoOeahOepuuagvFxuICAgIC8vIOWOu+aOieWMheijueS7o+eggeeahOespuWPt+mHjOmdouWinuWKoOeahOepuuagvFxuICAgIC8vIOWOu+aOieW8gOWniyBgIOWQjumdouWinuWKoOeahOepuuagvO+8jOe7k+adnyBgIOWJjemdouWinuWKoOeahOepuuagvFxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbYFxcJF0pXFxzKihbPFxcKFxcW1xce10pKFteXFwkXSopXFxzKihbYFxcJF0pL2csICckMSQyJDMkNCcpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbYFxcJF0pXFxzKihbXlxcJF0qKShbPlxcKVxcXVxcfV0pXFxzKihbYFxcJF0pL2csICckMSQyJDMkNCcpO1xuXG4gICAgLy8g5Y675o6J44CMYCkgX2DjgI3jgIHjgIxgKSBeYOOAjeWinuWKoOeahOepuuagvFxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcKVxccyhbX1xcXl0pL2csICcpJDEnKTtcblxuICAgIC8vIOWOu+aOiSBbXmZvb3Rub3RlLDIwMDJdIOS4reeahOepuuagvFxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcW1xccypcXF4oW15cXF1cXHNdKilcXHMqXFxdL2csICdbXiQxXScpO1xuXG4gICAgLy8g5bCG6ZO+5o6l55qE5qC85byP5Lit5paH5ous5Y+34oCcW13vvIjvvInigJ3mlLnmiJDoi7Hmlofmi6zlj7figJxbXSgp4oCd77yM5Y675o6J5aKe5Yqg55qE56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKlxcW1xccyooW15cXF1dKylcXHMqXFxdXFxzKlvvvIgoXVxccyooW15cXHNcXCldKilcXHMqWynvvIldXFxzKi9nLCAnIFskMV0oJDIpICcpO1xuXG4gICAgLy8g5bCG5Zu+54mH6ZO+5o6l55qE5qC85byP5Lit55qE5aSa5L2Z56m65qC84oCcISBbXSgp4oCd5Y675o6J77yM5Y+Y5oiQ4oCcIVtdKCnigJ1cbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8hXFxzKlxcW1xccyooW15cXF1dKylcXHMqXFxdXFxzKlvvvIgoXVxccyooW15cXHNcXCldKilcXHMqWynvvIldXFxzKi9nLCAnIVskMV0oJDIpICcpO1xuXG4gICAgLy8g5bCG572R57uc5Zyw5Z2A5Lit4oCcIDogLy8g4oCd56ym5Y+35pS55oiQ4oCcOi8v4oCdXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKjpcXHMqXFwvXFxzKlxcL1xccyovZywgJzovLycpO1xuXG4gICAgLy8g5Y675o6J6KGM5pyr56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcUyopXFxzKiQvZywgJyQxJyk7XG5cbiAgICAvLyDljrvmjonjgIwxMjMgwrDjgI3lkowg44CMMTUgJeOAjeS4reeahOepuuagvFxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbMC05XSlcXHMqKFvCsCVdKS9nLCAnJDEkMicpO1xuXG4gICAgLy8g5Y675o6JIDIwMjAgLSAwNCAtIDIwLCAwOCA6IDAwIDogMDAg6L+Z56eN5pel5pyf5pe26Ze06KGo56S655qE5pWw5a2X5YaF55qE56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFswLTldKVxccyotXFxzKihbMC05XSkvZywgJyQxLSQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFswLTldKVxccyo6XFxzKihbMC05XSkvZywgJyQxOiQyJyk7XG5cbiAgICAvLyDljrvmjokgMSAsIDIzNCAsIDU2NyDov5nnp43ljYPliIbkvY3ooajnpLrnmoTmlbDlrZflhoXnmoTnqbrmoLxcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oWzAtOV0pXFxzKixcXHMqKFswLTldKS9nLCAnJDEsJDInKTtcblxuICAgIC8vIOWFqOinkuaomem7nuiIh+WFtuS7luWtl+espuS5i+mWk+S4jeWKoOepuuagvFxuICAgIC8vIOWwhuaXoOW6j+WIl+ihqOeahC3lkI7pnaLnmoTnqbrmoLzkv53nlZlcbiAgICAvLyDlsIbmnInluo/liJfooajnmoQt5ZCO6Z2i55qE56m65qC85L+d55WZXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXig/PCFbLXxcXGQuXVxccyopXFxzKihb77yM44CC44CB44CK44CL77yf44CO44CP44CM44CN77yb4oi244CQ44CR772b772d4oCU77yB77yg77+l77yF4oCm77yI77yJXSlcXHMqL2csICckMScpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9LFxuXG4gIGluc2VydFNwYWNlKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8g5ZyoIOKAnOS4reaWh0VuZ2xpc2jigJ0g5LmL6Ze05Yqg5YWl56m65qC8IOKAnOS4reaWhyBFbmdsaXNo4oCdXG4gICAgLy8g5ZyoIOKAnOS4reaWhzEyM+KAnSDkuYvpl7TliqDlhaXnqbrmoLwg4oCc5Lit5paHIDEyM+KAnVxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbXFx1NGUwMC1cXHU5ZmE1XFx1MzA0MC1cXHUzMEZGXSkoW2EtekEtWjAtOWBdKS9nLCAnJDEgJDInKTtcblxuICAgIC8vIOWcqCDigJxFbmdsaXNo5Lit5paH4oCdIOS5i+mXtOWKoOWFpeepuuagvCDigJxFbmdsaXNoIOS4reaWh+KAnVxuICAgIC8vIOWcqCDigJwxMjPkuK3mlofigJ0g5LmL6Ze05Yqg5YWl56m65qC8IOKAnDEyMyDkuK3mlofigJ1cbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW2EtekEtWjAtOSVgXSkoWypdKltcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKS9nLCAnJDEgJDInKTtcblxuICAgIC8vIOWcqCDjgIxJIHNhaWQ6aXQncyBhIGdvb2QgbmV3c+OAjeeahOWGkuWPt+S4juiLseaWh+S5i+mXtOWKoOWFpeepuuagvCDjgIxJIHNhaWQ6IGl0J3MgYSBnb29kIG5ld3PjgI1cbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oWzpdKVxccyooW2EtekEtel0pL2csICckMSAkMicpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9LFxuICByZXBsYWNlUHVuY3R1YXRpb25zKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gYCwgXFwgLiA6IDsgPyAhYCDmlLnmiJAgYO+8jOOAgeOAgu+8mu+8m++8n++8gWBcbiAgICAvLyDlv4XpobvlnKjnu5PlsL7miJbogIXmnInnqbrmoLznmoTngrnmiY3ooqvmlLnmiJDlj6Xlj7dcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW1xcdTRlMDAtXFx1OWZhNVxcdTMwNDAtXFx1MzBGRl0pXFwuKCR8XFxzKikvZywgJyQx44CCJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFtcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKSwvZywgJyQx77yMJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFtcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKTsvZywgJyQx77ybJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFtcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKSEvZywgJyQx77yBJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFtcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKVxcPy9nLCAnJDHvvJ8nKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW1xcdTRlMDAtXFx1OWZhNVxcdTMwNDAtXFx1MzBGRl0pXFxcXC9nLCAnJDHjgIEnKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW1xcdTRlMDAtXFx1OWZhNVxcdTMwNDAtXFx1MzBGRl0p77y8cypcXDovZywgJyQx77yaJyk7XG5cbiAgICAvLyDnsKHpq5TkuK3mlofkvb/nlKjnm7Top5LlvJXomZ9cbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC/igJgvZywgJ+OAjicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL+KAmS9nLCAn44CPJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgv4oCcL2csICfjgIwnKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC/igJ0vZywgJ+OAjScpO1xuICAgIC8vIOaLrOWPt+S9v+eUqOWNiuinkuagh+eCuVxuICAgIC8vIOWNiuinkuaLrOWPt+eahOS4pOi+uemDveacieepuuagvOWwseS4jeWcqOi/memHjOWkhOeQhuS6hu+8jOaUvuWIsOihjOS4reWkhOeQhlxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xccypb77yIKF1cXHMqL2csICcgKCAnKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHMqW++8iSldXFxzKi9nLCAnICkgJyk7XG5cbiAgICAvLyDoi7HmloflkozmlbDlrZflhoXpg6jnmoTlhajop5LmoIfngrkgYO+8jOOAgu+8m+KAmOKAmeKAnOKAne+8mu+8n++8ge+8oO+8g++8he+8hu+8je+8ne+8i++9m++9neOAkOOAke+9nO+8vO+9nmDmlLnmiJDljYrop5LmoIfngrlcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvIxcXHMqKFxcdykvZywgJyQxLCAkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKuOAglxccyooXFx3KS9nLCAnJDEuICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77ybXFxzKihcXHcpL2csICckMTsgJDInKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrigJhcXHMqKFxcdykvZywgXCIkMSAnJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq4oCZXFxzKihcXHcpL2csIFwiJDEnICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKuKAnFxccyooXFx3KS9nLCAnJDEgXCIkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKuKAnVxccyooXFx3KS9nLCAnJDFcIiAkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8mlxccyooXFx3KS9nLCAnJDE6ICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yfXFxzKihcXHcpL2csICckMT8gJDInKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvIFcXHMqKFxcdykvZywgJyQxISAkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8oFxccyooXFx3KS9nLCAnJDFAJDInKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvINcXHMqKFxcdykvZywgJyQxIyQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yFXFxzKihcXHcpL2csICckMSAlICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yGXFxzKihcXHcpL2csICckMSAmICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yNXFxzKihcXHcpL2csICckMSAtICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77ydXFxzKihcXHcpL2csICckMSA9ICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yLXFxzKihcXHcpL2csICckMSArICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq772bXFxzKihcXHcpL2csICckMSB7JDInKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvZ1cXHMqKFxcdykvZywgJyQxfSAkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKlvjgJBcXFtdXFxzKihcXHcpL2csICckMSBbJDInKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccypb44CRXFxdXVxccyooXFx3KS9nLCAnJDFdICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq772cXFxzKihcXHcpL2csICckMSB8ICQyJyk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77y8XFxzKihcXHcpL2csICckMSAgJDInKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvZ5cXHMqKFxcdykvZywgJyQxfiQyJyk7XG4gICAgLy8g6L+e57ut5LiJ5Liq5Lul5LiK55qEIGDjgIJgIOaUueaIkCBgLi4uLi4uYFxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1vjgIJdezMsfS9nLCAn4oCm4oCmJyk7XG4gICAgLy8g5oiq5pat6L+e57ut6LaF6L+H5LiA5Liq55qEIO+8n+WSjO+8gSDkuLrkuIDkuKrvvIzjgIzvvIHvvJ/jgI3kuZ/nrpfkuIDkuKpcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW++8ge+8n10rKVxcMXsxLH0vZywgJyQxJyk7XG4gICAgLy8g5oiq5pat6L+e57ut6LaF6L+H5LiA5Liq55qEIOOAgu+8jO+8m++8muOAgeKAnOKAneOAjuOAj+OAluOAl+OAiuOAiyDkuLrkuIDkuKpcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW+OAgu+8jO+8m++8muOAgeKAnOKAneOAjuOAj+OAluOAl+OAiuOAi+OAkOOAkV0pXFwxezEsfS9nLCAnJDEnKTtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfSxcblxuICByZXBsYWNlRnVsbE51bWJlcnNBbmRDaGFycyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIOabv+aNouWFqOinkuaVsOWtlyAmIOWFqOinkuiLseaWh1xuICAgIC8vIO+8oSAtPiBBXG4gICAgLy8g77yQIC0+IDBcbiAgICByZXR1cm4gY29udGVudC5yZXBsYWNlKC9bXFx1RkYxMC1cXHVGRjE5XFx1RkYyMS1cXHVGRjVBXS9nLCBjID0+IFN0cmluZy5mcm9tQ2hhckNvZGUoYy5jaGFyQ29kZUF0KDApIC0gMHhmZWUwKSk7XG4gIH0sXG5cbiAgZm9ybWF0Q29udGVudChjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuXG5cbiAgICAvLyDmm7/mjaLmiYDmnInnmoTlhajop5LmlbDlrZflkozlrZfmr43kuLrljYrop5JcbiAgICBjb250ZW50ID0gdGhpcy5yZXBsYWNlRnVsbE51bWJlcnNBbmRDaGFycyhjb250ZW50KTtcblxuXG4gICAgLy8g5Yig6Zmk5aSa5L2Z55qE5YaF5a6577yI5Zue6L2m77yJXG4gICAgY29udGVudCA9IHRoaXMuY29uZGVuc2VDb250ZW50KGNvbnRlbnQpO1xuXG5cbiAgICAvLyDmr4/ooYzmk43kvZxcbiAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnRcbiAgICAgIC5zcGxpdCgnXFxuJyk7XG5cbiAgICBjb25zdCBpZ25vcmVCbG9ja3M6IElnbm9yZUJsb2NrW10gPSB0aGlzLmdldElnbm9yZUJsb2NrcyhsaW5lcyk7XG5cbiAgICBjb250ZW50ID0gbGluZXNcbiAgICAgIC5tYXAoKGxpbmU6IHN0cmluZywgaW5kZXg6IG51bWJlcikgPT4ge1xuXG4gICAgICAgIC8vIOW/veeVpeS7o+eggeWdl1xuICAgICAgICBpZiAoaWdub3JlQmxvY2tzLnNvbWUoKHsgc3RhcnQsIGVuZCB9KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGluZGV4ID49IHN0YXJ0ICYmIGluZGV4IDw9IGVuZDtcbiAgICAgICAgfSkpIHtcbiAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIOWIoOmZpOWkmuS9meeahOepuuagvFxuICAgICAgICBsaW5lID0gdGhpcy5kZWxldGVTcGFjZXMobGluZSk7XG5cbiAgICAgICAgLy8g5o+S5YWl5b+F6KaB55qE56m65qC8XG4gICAgICAgIGxpbmUgPSB0aGlzLmluc2VydFNwYWNlKGxpbmUpO1xuXG4gICAgICAgIC8vIOWwhuaciee8luWPt+WIl+ihqOeahOKAnDEuIOKAneaUueaIkCDigJwxLiAg4oCdXG4gICAgICAgIGxpbmUgPSBsaW5lLnJlcGxhY2UoL14oXFxzKikoXFxkXFwuKVxccysoXFxTKS8sICckMSQyICAkMycpO1xuXG4gICAgICAgIC8vIOWwhuaXoOe8luWPt+WIl+ihqOeahOKAnCog4oCd5pS55oiQIOKAnC0g4oCdXG4gICAgICAgIC8vIOWwhuaXoOe8luWPt+WIl+ihqOeahOKAnC0g4oCd5pS55oiQIOKAnC0g4oCdXG4gICAgICAgIGxpbmUgPSBsaW5lLnJlcGxhY2UoL14oXFxzKilbLVxcKl1cXHMrKFxcUykvLCAnJDEtICQyJyk7XG5cbiAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICB9KVxuICAgICAgLmpvaW4oJ1xcbicpO1xuXG4gICAgLy8g57uT5p2f5paH5qGj5pW055CG5YmN5YaN5Yig6Zmk5pyA5ZCO5LiA5Liq5Zue6L2mXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcbil7Mix9JC9nLCAnJDEnKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFxyXFxuKXsyLH0kL2csICckMScpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9LFxufTtcbiIsImltcG9ydCB7IEFwcCwgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBmb3JtYXRVdGlsIGZyb20gJy4vZm9ybWF0VXRpbCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYW5ndSBleHRlbmRzIFBsdWdpbiB7XHJcbiAgZm9ybWF0KGNtOiBDb2RlTWlycm9yLkVkaXRvcik6IHZvaWQge1xyXG4gICAgbGV0IGN1cnNvciA9IGNtLmdldEN1cnNvcigpO1xyXG4gICAgbGV0IGN1cnNvckNvbnRlbnQgPSBjbS5nZXRSYW5nZSh7IC4uLmN1cnNvciwgY2g6IDAgfSwgY3Vyc29yKTtcclxuICAgIGNvbnN0IHsgdG9wIH0gPSBjbS5nZXRTY3JvbGxJbmZvKCk7XHJcblxyXG4gICAgY3Vyc29yQ29udGVudCA9IGZvcm1hdFV0aWwuZm9ybWF0Q29udGVudChjdXJzb3JDb250ZW50KTtcclxuXHJcbiAgICBsZXQgY29udGVudCA9IGNtLmdldFZhbHVlKCkudHJpbSgpO1xyXG4gICAgY29udGVudCA9IGNvbnRlbnQgKyAnXFxuXFxuJztcclxuICAgIGNvbnRlbnQgPSBmb3JtYXRVdGlsLmZvcm1hdENvbnRlbnQoY29udGVudCk7XHJcblxyXG4gICAgY20uc2V0VmFsdWUoY29udGVudCk7XHJcblxyXG4gICAgY20uc2Nyb2xsVG8obnVsbCwgdG9wKTtcclxuXHJcbiAgICAvLyDkv53mjIHlhYnmoIfmoLzlvI/ljJblkI7kuI3lj5hcclxuICAgIGNvbnN0IG5ld0RvY0xpbmUgPSBjbS5nZXRMaW5lKGN1cnNvci5saW5lKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGN1cnNvciA9IHsgLi4uY3Vyc29yLCBjaDogbmV3RG9jTGluZS5pbmRleE9mKGN1cnNvckNvbnRlbnQpICsgY3Vyc29yQ29udGVudC5sZW5ndGggfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7fVxyXG5cclxuICAgIGNtLnNldEN1cnNvcihjdXJzb3IpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdwYW5ndS1mb3JtYXQnLFxyXG4gICAgICBuYW1lOiAn5Li65Lit6Iux5paH5a2X56ym6Ze06Ieq5Yqo5Yqg5YWl56m65qC8JyxcclxuICAgICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgICBjb25zdCBhY3RpdmVMZWFmVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgaWYgKGFjdGl2ZUxlYWZWaWV3KSB7XHJcbiAgICAgICAgICB0aGlzLmZvcm1hdChhY3RpdmVMZWFmVmlldy5zb3VyY2VNb2RlLmNtRWRpdG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGhvdGtleXM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBtb2RpZmllcnM6IFsnTW9kJywgJ1NoaWZ0J10sXHJcbiAgICAgICAgICBrZXk6ICdzJyxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIG1vZGlmaWVyczogWydDdHJsJywgJ1NoaWZ0J10sXHJcbiAgICAgICAgICBrZXk6ICdzJyxcclxuICAgICAgICB9LFxyXG4gICAgICBdLFxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBQYW5ndVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuICB9XHJcblxyXG4gIG9udW5sb2FkKCkge1xyXG4gICAgY29uc29sZS5sb2coJ3VubG9hZGluZyBwbHVnaW4nKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWRTZXR0aW5ncygpIHt9XHJcbn1cclxuXHJcbmNsYXNzIFBhbmd1U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gIHBsdWdpbjogUGFuZ3U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFBhbmd1KSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdQYW5ndSDkvb/nlKjor7TmmI4nIH0pO1xyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoJycpLnNldERlc2MoJ+m7mOiupOW/q+aNt+mUruS4ujpNYWMgLSBDb21tYW5kICsgU2hpZnQgKyBT77yMV2luZG93cyAtICBTaGlmdCArIEN0cmwgKyBT44CC5b2T54S277yM5oKo5Y+v5Lul5Yiw44CM6K6+572uIC0g5b+r5o236ZSu44CN6YeM6L+b6KGM5pu05pS544CCJyk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJQbHVnaW4iLCJNYXJrZG93blZpZXciLCJQbHVnaW5TZXR0aW5nVGFiIiwiU2V0dGluZyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1REE7QUFDTyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTLEVBQUU7QUFDN0QsSUFBSSxTQUFTLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxPQUFPLEtBQUssWUFBWSxDQUFDLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLFVBQVUsT0FBTyxFQUFFLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUU7QUFDaEgsSUFBSSxPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRSxVQUFVLE9BQU8sRUFBRSxNQUFNLEVBQUU7QUFDL0QsUUFBUSxTQUFTLFNBQVMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxD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QUFPLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNyQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDckMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDOzs7UUFHckMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ2hELE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQzs7UUFHaEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsc0JBQXNCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDNUQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsc0JBQXNCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDNUQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7O1FBRXZELE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQzs7UUFFNUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLENBQUM7O1FBRWxELE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLDRCQUE0QixFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzlELE9BQU8sT0FBTyxDQUFDO0tBQ2hCO0lBRUQsMEJBQTBCLENBQUMsT0FBZTs7OztRQUl4QyxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsK0JBQStCLEVBQUUsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDO0tBQzdHO0lBRUQsYUFBYSxDQUFDLE9BQWU7O1FBSTNCLE9BQU8sR0FBRyxJQUFJLENBQUMsMEJBQTBCLENBQUMsT0FBTyxDQUFDLENBQUM7O1FBSW5ELE9BQU8sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDOztRQUl4QyxNQUFNLEtBQUssR0FBRyxPQUFPO2FBQ2xCLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVmLE1BQU0sWUFBWSxHQUFrQixJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRWhFLE9BQU8sR0FBRyxLQUFLO2FBQ1osR0FBRyxDQUFDLENBQUMsSUFBWSxFQUFFLEtBQWE7O1lBRy9CLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRTtnQkFDbkMsT0FBTyxLQUFLLElBQUksS0FBSyxJQUFJLEtBQUssSUFBSSxHQUFHLENBQUM7YUFDdkMsQ0FBQyxFQUFFO2dCQUNGLE9BQU8sSUFBSSxDQUFDO2FBQ2I7O1lBR0QsSUFBSSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7O1lBRy9CLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDOztZQUc5QixJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsRUFBRSxVQUFVLENBQUMsQ0FBQzs7O1lBSXZELElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRXBELE9BQU8sSUFBSSxDQUFDO1NBQ2IsQ0FBQzthQUNELElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzs7UUFHZCxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDOUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2hELE9BQU8sT0FBTyxDQUFDO0tBQ2hCO0NBQ0Y7O01DcE5vQixLQUFNLFNBQVFBLGVBQU07SUFDdkMsTUFBTSxDQUFDLEVBQXFCO1FBQzFCLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUM1QixJQUFJLGFBQWEsR0FBRyxFQUFFLENBQUMsUUFBUSxpQ0FBTSxNQUFNLEtBQUUsRUFBRSxFQUFFLENBQUMsS0FBSSxNQUFNLENBQUMsQ0FBQztRQUM5RCxNQUFNLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBRW5DLGFBQWEsR0FBRyxVQUFVLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBRXhELElBQUksT0FBTyxHQUFHLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNuQyxPQUFPLEdBQUcsT0FBTyxHQUFHLE1BQU0sQ0FBQztRQUMzQixPQUFPLEdBQUcsVUFBVSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUU1QyxFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXJCLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDOztRQUd2QixNQUFNLFVBQVUsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQyxJQUFJO1lBQ0YsTUFBTSxtQ0FBUSxNQUFNLEtBQUUsRUFBRSxFQUFFLFVBQVUsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLEdBQUcsYUFBYSxDQUFDLE1BQU0sR0FBRSxDQUFDO1NBQ3RGO1FBQUMsT0FBTyxLQUFLLEVBQUUsR0FBRTtRQUVsQixFQUFFLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0tBQ3RCO0lBRUssTUFBTTs7WUFDVixJQUFJLENBQUMsVUFBVSxDQUFDO2dCQUNkLEVBQUUsRUFBRSxjQUFjO2dCQUNsQixJQUFJLEVBQUUsZUFBZTtnQkFDckIsUUFBUSxFQUFFO29CQUNSLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLG1CQUFtQixDQUFDQyxxQkFBWSxDQUFDLENBQUM7b0JBQzVFLElBQUksY0FBYyxFQUFFO3dCQUNsQixJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7cUJBQ2pEO2lCQUNGO2dCQUNELE9BQU8sRUFBRTtvQkFDUDt3QkFDRSxTQUFTLEVBQUUsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDO3dCQUMzQixHQUFHLEVBQUUsR0FBRztxQkFDVDtvQkFDRDt3QkFDRSxTQUFTLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDO3dCQUM1QixHQUFHLEVBQUUsR0FBRztxQkFDVDtpQkFDRjthQUNGLENBQUMsQ0FBQztZQUVILElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxlQUFlLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1NBQ3pEO0tBQUE7SUFFRCxRQUFRO1FBQ04sT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0tBQ2pDO0lBRUssWUFBWTsrREFBSztLQUFBO0NBQ3hCO0FBRUQsTUFBTSxlQUFnQixTQUFRQyx5QkFBZ0I7SUFHNUMsWUFBWSxHQUFRLEVBQUUsTUFBYTtRQUNqQyxLQUFLLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0tBQ3RCO0lBRUQsT0FBTztRQUNMLElBQUksRUFBRSxXQUFXLEVBQUUsR0FBRyxJQUFJLENBQUM7UUFDM0IsV0FBVyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3BCLFdBQVcsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUM7UUFDbkQsSUFBSUMsZ0JBQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLHNGQUFzRixDQUFDLENBQUM7S0FDdEk7Ozs7OyJ9
